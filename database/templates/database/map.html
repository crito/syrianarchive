{% extends "base.html" %}
{% load i18n %}
{% load leaflet_tags %}
{% load geojson_tags %}

{% block javascripts %}
  {% leaflet_js %}
  {% leaflet_css %}
{% endblock %}

{% block main %}

  <div class="row titlerow">
    <div class="col-md-12">
      <h1 class="pagetitle">{% trans "Incident Map" %}</h1>
    </div>
  </div>


    <script type="text/javascript">
      var collection = {{ qs_results|geojsonfeature|safe }};
      function map_init (map, options) {

            var dataurl = '{% url "incidents" %}';
            // Download GeoJSON via Ajax
            $.getJSON(dataurl, function (data) {
                // Add GeoJSON layer
                L.geoJson(data).addTo(map);
            });

        }

    </script>

  <div class="row maprow">

    {% leaflet_map "incidents" callback="window.map_init" %}

  </div>

{% endblock %}