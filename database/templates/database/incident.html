{% extends "base.html" %}
{% load i18n %}
{% load leaflet_tags %}
{% load geojson_tags %}

{% block title %}{% trans "Incident" %} - {% endblock %}


{% block main %}


	<div class="row titlerow">
		<div class="col-md-12">
			<h1 class="pagetitle">{{incident.name}}</h1>
            {% if incident.graphic_content == True %}
            <div id = "graphic_content">
                {% trans "This video contains graphic content.  Viewer discretion is advised." %}
            </div>
            {% endif %}
		</div>
	</div>



<div class="row" style="overflow:hidden;">

</div>

<div class="row">

	<div class="col-md-6"  style="overflow:hidden;">
        {% if incident.video_url != None %}
		<video src="{{incident.video_url}}" width="100%" height="500px"></video>
		<div class="section">

				<p><strong>{% trans "Video Url" %}</strong>: {{incident.video_url|safe}}</p>
		</div>
        {% else %}
            <div class="section">
                {% trans "Video not Available" %}
            </div>
        {% endif %}



        <div class = "section">
            {% leaflet_map "incident" callback="window.map_init" %}
        </div>
	</div>

	<div class="col-md-6">
			{% if user.is_authenticated %}
			<div class="section">
				<a href="{% url 'admin:database_databaseentry_change' slug %}">edit</a>
			</div>
			{% endif %}
			<div class="section">

				<p><strong>{% trans "Reference Code" %}</strong>: {{incident.reference_code}}</p>

				<p><strong>{% trans "Description" %}</strong>: {{incident.description}}</p>

				<p><strong>{% trans "Recording Date" %}</strong>: {{incident.recording_date}}</p>

				<p><strong>{% trans "Contains Graphic Content" %}</strong>: {{incident.graphic_content}}</p>
				<p><strong>{% trans "Keywords" %}</strong>: {{incident.keywords}}</p>

				<p><strong>{% trans "Languages" %}</strong>: {{incident.languages}}</p>

			</div>

			<div class="section">
				<p><strong>{% trans "Location" %}</strong>: {% for locations in incident.location.all %}
				{{locations}}<br>
				{% endfor %}</p>
				<p><strong>{% trans "Location Latitude" %}</strong>: {{incident.location_latitude}}</p>
				<p><strong>{% trans "Location Longitude" %}</strong>: {{incident.location_longitude}}</p>
				<p><strong>{% trans "Landmarks" %}</strong>: {{incident.landmarks}}</p>
				<p><strong>{% trans "Weather in Media" %}</strong>: {{incident.weather_in_media}}</p>
			</div>

			<div class="section">
				<p><strong>{% trans "Type of Violation" %}</strong>:
		            {% for incidents in incident.type_of_violation.all %}
						{{incidents}}<br>
					{% endfor %}

				</p>
				<p><strong>{% trans "Clothes and Uniforms" %}</strong>: {{incident.cloths_and_uniforms}}</p>
				<p><strong>{% trans "Sex" %}</strong>: {{incident.gender_or_sex}}</p>
				<p><strong>{% trans "Weapons Used" %}</strong>: {{incident.weapons_used}}</p>

			</div>

			<div class="section">
				<p><strong>{% trans "Edited" %}</strong>: {{incident.edited}}</p>
				<p><strong>{% trans "File Size" %}</strong>: {{incident.file_size}}</p>
				<p><strong>{% trans "Duration" %}</strong>: {{incident.duration}}</p>
				<p><strong>{% trans "Device used to record" %}</strong>:
		            {% for device in incident.device_used.all %}
				      {{device}}<br>
				    {% endfor %}</p>
				<p><strong>{% trans "Media Content Type" %}</strong>:
		            {% for media in incident.media_content_type.all %}
				      {{media}}<br>
				      {% endfor %}
				</p>

			</div>

			<div class="section">
				<p><strong>{% trans "Chain of Custody Notes" %}</strong>: {{incident.chain_of_custody_notes_public}}</p>
				<p><strong>{% trans "Finding Aids" %}</strong>: {{incident.finding_aids}}</p>

				<p><strong>{% trans "International Instrument" %}</strong>:
		            {% for instrument in incident.international_instrument.all %}
		                {{instrument}}
		            {% endfor %}</br></p>
				<p><strong>{% trans "International Instrument Notes" %}</strong>: {{incident.international_instrument_notes}}</p>

			</div>

			<div class="section">

				<p><strong>{% trans "URLs and News" %}</strong>: {{incident.urls_and_news}}</p>
				<p><strong>{% trans "Reliability Score" %}</strong>: {{incident.reliability_score}}</p>
				<p><strong>{% trans "Related Incidents" %}</strong>:
		            {% for incident in incident.related_incidents.all%}
				      {{incident}}<br>
		            {% endfor %}</p>
			</div>
</div>

</div>
{% endblock %}


{% block javascripts %}

{% leaflet_js %}
  {% leaflet_css %}

	<script src="/static/mediaelement/mediaelement-and-player.min.js"></script>
	<link rel="stylesheet" href="/static/mediaelement/mediaelementplayer.css" />
	<script>
	// using jQuery
	$('video,audio').mediaelementplayer(/* Options */);

    function map_init (map, options) {

            // Download GeoJSON via Ajax
                // Add GeoJSON layer
                var geodata = {{ geofield | safe}};
                console.log(geodata);
                L.geoJson(geodata).addTo(map);
                console.log(geodata.coordinates[0]);
                map.setView(new L.LatLng(geodata.coordinates[1], geodata.coordinates[0]), 10);


        }
	</script>


{% endblock %}